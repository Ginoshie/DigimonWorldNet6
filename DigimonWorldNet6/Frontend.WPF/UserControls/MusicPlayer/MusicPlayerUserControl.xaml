<UserControl x:Class="DigimonWorld.Frontend.WPF.UserControls.MusicPlayer.MusicPlayerUserControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:musicPlayer="clr-namespace:DigimonWorld.Frontend.WPF.UserControls.MusicPlayer"
             xmlns:system="clr-namespace:System;assembly=System.Runtime"
             mc:Ignorable="d"
             d:DataContext="{d:DesignInstance Type=musicPlayer:MusicPlayerViewModel, IsDesignTimeCreatable=True}">

    <UserControl.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="../../ResourceDictionaries/Styles/Buttons/DefaultButtonStyle.xaml" />
                <ResourceDictionary Source="../../ResourceDictionaries/Styles/ProgressBarStyle.xaml" />
                <ResourceDictionary Source="../../ResourceDictionaries/ControlTemplates/DefaultHorizontalSliderTemplate.xaml" />
                <ResourceDictionary Source="../../ResourceDictionaries/Styles/Buttons/DefaultToggleButtonStyle.xaml" />
                <ResourceDictionary Source="../../ResourceDictionaries/Styles/Buttons/VolumeMuteButtonStyle.xaml" />
            </ResourceDictionary.MergedDictionaries>

            <system:Double x:Key="ButtonDimension">40</system:Double>
            <system:Double x:Key="ButtonFontSize">25</system:Double>

        </ResourceDictionary>
    </UserControl.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="auto" />
            <RowDefinition Height="auto" />
            <RowDefinition Height="auto" />
            <RowDefinition Height="auto" />
        </Grid.RowDefinitions>
        
        <!-- Song title-->
        <TextBlock Grid.Row="0"
                   Text="{Binding CurrentSongTitle}"
                   Foreground="#D6D6D8"
                   FontSize="16"
                   Margin="0, 10"
                   TextWrapping="Wrap" />

        <Grid Grid.Row="1" VerticalAlignment="Center">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="Auto" />
            </Grid.ColumnDefinitions>

            <!-- Current position in song -->
            <TextBlock Grid.Column="0" Text="{Binding CurrentPositionString}"
                       Foreground="#B3B5B1"
                       Height="10"
                       VerticalAlignment="Center"
                       HorizontalAlignment="Left"
                       Margin="0,0,5,0" />

            <!-- Song progress bar -->
            <ProgressBar Grid.Column="1" Style="{StaticResource  CustomProgressBarStyle}"
                         Value="{Binding CurrentPosition}"
                         Height="10"
                         VerticalAlignment="Center"
                         HorizontalAlignment="Stretch"
                         Margin="0,0,0,0"
                         Minimum="0"
                         Maximum="{Binding SongLength}" />

            <!-- Total song length -->
            <TextBlock Grid.Column="2" Text="{Binding SongLengthString}"
                       Foreground="#B3B5B1"
                       Height="10"
                       VerticalAlignment="Center"
                       HorizontalAlignment="Right"
                       Margin="5,0,0,0" />
        </Grid>

        <StackPanel Grid.Row="2" Orientation="Horizontal" Margin="0,10">
            <!-- Shuffle button -->
            <Button Style="{StaticResource DefaultToggleButtonStyle}"
                    Content="ðŸ”€"
                    Command="{Binding ToggleShuffleCommand}"
                    Height="{StaticResource ButtonDimension}"
                    Width="{StaticResource ButtonDimension}"
                    FontSize="{StaticResource ButtonFontSize}"
                    Margin="0, 0, 1, 0"
                    Tag="{Binding ShuffleEnabled}" />

            <!-- Previous track button -->
            <Button Style="{StaticResource DefaultButtonStyle}"
                    Content="â®ï¸"
                    Command="{Binding PreviousSongCommand}"
                    Height="{StaticResource ButtonDimension}"
                    Width="{StaticResource ButtonDimension}"
                    FontSize="{StaticResource ButtonFontSize}"
                    Margin="15, 0, 0, 0" />

            <!-- Play/Pause button -->
            <Button Style="{StaticResource DefaultButtonStyle}"
                    Content="â¯ï¸"
                    Command="{Binding PlayPauseCommand}"
                    Height="{StaticResource ButtonDimension}"
                    Width="{StaticResource ButtonDimension}"
                    FontSize="{StaticResource ButtonFontSize}"
                    Margin="0, 0, 0, 0" />

            <!-- Next track button -->
            <Button Style="{StaticResource DefaultButtonStyle}"
                    Content="â­ï¸"
                    Command="{Binding NextSongCommand}"
                    Height="{StaticResource ButtonDimension}"
                    Width="{StaticResource ButtonDimension}"
                    FontSize="{StaticResource ButtonFontSize}"
                    Margin="0, 0, 15, 0" />

            <!-- Repeat button -->
            <Button Style="{StaticResource DefaultToggleButtonStyle}"
                    Content="ðŸ”"
                    Command="{Binding ToggleRepeatSingleSongCommand}"
                    Height="{StaticResource ButtonDimension}"
                    Width="{StaticResource ButtonDimension}"
                    FontSize="{StaticResource ButtonFontSize}"
                    Margin="0, 0, 0, 0"
                    Tag="{Binding RepeatSingleSongEnabled}" />

        </StackPanel>

        <!-- Volume section -->
        <Grid Grid.Row="3">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="Auto" />
            </Grid.ColumnDefinitions>
            
            <!-- Volume slider -->
            <StackPanel Grid.Column="0" Orientation="Vertical" HorizontalAlignment="Stretch" VerticalAlignment="Center">
                
                <!-- Volume label -->
                <Grid HorizontalAlignment="Center">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>

                    <TextBlock Grid.Column="0"
                               Foreground="#B3B5B1" 
                               VerticalAlignment="Bottom" 
                               TextAlignment="Right" 
                               Margin="0,5">
                        Volume:&#160;
                    </TextBlock>

                    <TextBlock Grid.Column="1" 
                               Foreground="#B3B5B1" 
                               VerticalAlignment="Bottom" 
                               HorizontalAlignment="Center" 
                               Width="22" 
                               Margin="0,5">
                        <Run Text="{Binding ElementName=VolumeSlider, Path=Value}" />
                    </TextBlock>
                </Grid>

                <!-- Volume slider -->
                <Slider x:Name="VolumeSlider" 
                        Template="{StaticResource DefaultHorizontalSliderTemplate}" 
                        Focusable="False" SnapsToDevicePixels="True"
                        Minimum="0" 
                        Maximum="100" 
                        Value="{Binding Volume, Mode=TwoWay}" 
                        TickFrequency="10" IsSnapToTickEnabled="False"
                        IsMoveToPointEnabled="True" 
                        VerticalAlignment="Center" 
                        HorizontalAlignment="Stretch" />
            </StackPanel>

            <!-- Volume mute button -->
            <Button Grid.Column="1" Style="{StaticResource VolumeMuteButtonStyle}"
                    Command="{Binding ToggleMuteEnabledCommand}"
                    FontSize="{StaticResource ButtonFontSize}"
                    Height="{StaticResource ButtonDimension}" 
                    Width="{StaticResource ButtonDimension}" 
                    Margin="15, 10, 0,10" />
        </Grid>
    </Grid>
</UserControl>